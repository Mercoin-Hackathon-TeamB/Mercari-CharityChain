const Web3 = require("web3");
const web3 = new Web3("http://127.0.0.1:7546");

const bytecode =
  "608060405234801561001057600080fd5b5060008081905550610585806100276000396000f3fe60806040526004361061003f5760003560e01c806312065fe014610044578063cd4646cb1461006f578063de2ed89314610098578063ed88c68e146100c3575b600080fd5b34801561005057600080fd5b506100596100cd565b60405161006691906103a6565b60405180910390f35b34801561007b57600080fd5b5061009660048036038101906100919190610256565b6100d5565b005b3480156100a457600080fd5b506100ad6101c9565b6040516100ba91906103a6565b60405180910390f35b6100cb6101cf565b005b600047905090565b80471015610118576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161010f90610366565b60405180910390fd5b60008273ffffffffffffffffffffffffffffffffffffffff168260405161013e90610331565b60006040518083038185875af1925050503d806000811461017b576040519150601f19603f3d011682016040523d82523d6000602084013e610180565b606091505b50509050806101c4576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016101bb90610346565b60405180910390fd5b505050565b60005481565b60003411610212576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161020990610386565b60405180910390fd5b3460008082825461022391906103dd565b92505081905550565b60008135905061023b81610521565b92915050565b60008135905061025081610538565b92915050565b6000806040838503121561026d5761026c61049e565b5b600061027b8582860161022c565b925050602061028c85828601610241565b9150509250929050565b60006102a36014836103cc565b91506102ae826104a3565b602082019050919050565b60006102c66020836103cc565b91506102d1826104cc565b602082019050919050565b60006102e96000836103c1565b91506102f4826104f5565b600082019050919050565b600061030c601c836103cc565b9150610317826104f8565b602082019050919050565b61032b81610465565b82525050565b600061033c826102dc565b9150819050919050565b6000602082019050818103600083015261035f81610296565b9050919050565b6000602082019050818103600083015261037f816102b9565b9050919050565b6000602082019050818103600083015261039f816102ff565b9050919050565b60006020820190506103bb6000830184610322565b92915050565b600081905092915050565b600082825260208201905092915050565b60006103e882610465565b91506103f383610465565b9250827fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff038211156104285761042761046f565b5b828201905092915050565b600061043e82610445565b9050919050565b600073ffffffffffffffffffffffffffffffffffffffff82169050919050565b6000819050919050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052601160045260246000fd5b600080fd5b7f4661696c656420746f2073656e64204574686572000000000000000000000000600082015250565b7f496e73756666696369656e742062616c616e636520696e20636f6e7472616374600082015250565b50565b7f446f6e6174696f6e206d757374206265206d6f7265207468616e203000000000600082015250565b61052a81610433565b811461053557600080fd5b50565b61054181610465565b811461054c57600080fd5b5056fea2646970667358221220da95364f2bc0a6d1d2a6891ac77149814271cdea3584909cbf0830fb8154cae064736f6c63430008070033";
const abi = [
  {
    inputs: [],
    name: "donate",
    outputs: [],
    stateMutability: "payable",
    type: "function",
  },
  {
    inputs: [
      {
        internalType: "address payable",
        name: "recipient",
        type: "address",
      },
      {
        internalType: "uint256",
        name: "amount",
        type: "uint256",
      },
    ],
    name: "sendDonation",
    outputs: [],
    stateMutability: "nonpayable",
    type: "function",
  },
  {
    inputs: [],
    stateMutability: "nonpayable",
    type: "constructor",
  },
  {
    inputs: [],
    name: "getBalance",
    outputs: [
      {
        internalType: "uint256",
        name: "",
        type: "uint256",
      },
    ],
    stateMutability: "view",
    type: "function",
  },
  {
    inputs: [],
    name: "totalDonations",
    outputs: [
      {
        internalType: "uint256",
        name: "",
        type: "uint256",
      },
    ],
    stateMutability: "view",
    type: "function",
  },
];

const contract = new web3.eth.Contract(abi);
const deploy = contract.deploy({ data: "0x" + bytecode });

web3.eth.getAccounts().then((accounts) => {
  web3.eth
    .sendTransaction({
      from: accounts[0],
      data: deploy.encodeABI(),
      gas: 5000000,
    })
    .then((receipt) => {
      console.log("Contract deployed at address:", receipt.contractAddress);
    });
});
